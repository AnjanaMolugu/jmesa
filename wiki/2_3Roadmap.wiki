The JMesa 2.3 release should be out the first quarter of 2008. For more information about the worksheet you can read the [Worksheet specs] page.

http://jmesa.org/wiki/images/worksheet-save.gif

 * *01/27/2008:* The first alpha release of the worksheet functionality is out! If you are interested in testing it out and offering feedback it is available in the downloads section of this site (jmesa-2.3_08.01.27.zip). Just know that this is very new though, and considered alpha software. It is also missing core functionality like error messaging, but I expect to get that done soon!

*After you get the chance to work with the worksheet be sure to send me an email with any feedback you have. It could be as simple as just letting me know its working, or not working! You can just email me directly at extremecomponents@gmail.com.*

_The example [http://jmesa.googlecode.com/svn/trunk/jmesaWeb/src/org/jmesaweb/controller/WorksheetPresidentController.java  source code] is checked into the web project. Be sure to look at that for a better idea on how to work with the worksheet functionality. Also note that so far the functionality has only been tested on Firefox using [http://www.ubuntu.com/ Ubuntu] Linux. Throughout the week I will be updating the wiki to give better instructions on how the worksheet functions._

==== Setup ====

First you need to set up the servlet. The servlet is used with AJAX technology to update the worksheet as the user is interacting with the table. That way there are no page refreshes for the current page someone is editing.

{{{
<servlet>
    <servlet-name>worksheet</servlet-name>
    <servlet-class>org.jmesa.worksheet.servlet.WorksheetServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>worksheet</servlet-name>
    <url-pattern>*.wrk</url-pattern>
</servlet-mapping>
}}}

==== Set Table to be Editable ====

Then set the table to be editable:

{{{
tableFacade.setEditable(true);

// the unique worksheet properties to identify the row
row.setUniqueProperties("id"); 
}}}

==== Retrieving Values ====

Working with the worksheet makes working with an editable table clean and effortless. The following shows how you would iterate over the worksheet to see what was changed.

{{{
private void saveWorksheet(TableFacade tableFacade) {
    Worksheet worksheet = tableFacade.getWorksheet();

    if (worksheet.isSaved()) {
        logger.debug("******Saving the worksheet!********");

        Collection<WorksheetRow> worksheetRows = worksheet.getRows();
        for (WorksheetRow worksheetRow : worksheetRows) {
            logger.debug("the unique properties are " + worksheetRow.getUniqueProperties());

            Collection<WorksheetColumn> worksheetColumns = worksheetRow.getColumns();
            for (WorksheetColumn worksheetColumn : worksheetColumns) {
                logger.debug("changed value [" + worksheetColumn.getChangedValue() + "] -- original value [" + worksheetColumn.getOriginalValue() + "]");
            }
        }
        worksheet.removeAllChanges();
    }
}
}}}