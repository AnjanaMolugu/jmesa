If you are rendering html then pass the view into the servlet request. If you are exporting then just set the export directly on the response. The following example is using Spring, but there is nothing Spring specific happening.

{{{
protected ModelAndView handleRequestInternal(HttpServletRequest request, HttpServletResponse response)
        throws Exception {
    ModelAndView mv = new ModelAndView(successView);

    WebContext webContext = new HttpServletRequestWebContext(request);
    Collection items = presidentsService.getPresidents();
    Limit limit = getLimit(items, webContext);
    CoreContext coreContext = getCoreContext(items, limit, webContext);

    if (limit.isExportable()) {
        String type = limit.getExport().getType();
        if (type.equals(CSV)) {
            csvTable(webContext, coreContext, response);
            return null;
        }
    }

    Object presidents = htmlTable(webContext, coreContext);
    mv.addObject("presidents", presidents);

    return mv;
}
}}}

